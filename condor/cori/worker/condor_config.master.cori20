

# Set COLLECTOR_HOST if collector's internal hostname doesn't match DNS name
# and also set sock=COLLECTOR if using shared port
# example:
# COLLECTOR_HOST = ci.kbase.us:9618?sock=collector
#
MASTER_NAME = jaws_jtm
SCHEDD_NAME = jaws_jtm
#SCHEDD_HOST = jaws_jtm@cori12
CONDOR_HOST = cori20-224.nersc.gov
#SCHEDD_HOST = jaws_jtm@$(CONDOR_HOST)
#COLLECTOR_HOST = $(CONDOR_HOST)
COLLECTOR_HOST = $(CONDOR_HOST)?sock=collector
#:9625?sock=collector


# If the environment variable USE_TCP is set to true, the template will enable
# this group of directives that convert communications to TCP
# per https://lists.cs.wisc.edu/archive/htcondor-users/2011-August/msg00085.shtml

UPDATE_COLLECTOR_WITH_TCP = True
UPDATE_VIEW_COLLECTOR_WITH_TCP = True
WANT_UDP_COMMAND_SOCKET = False
COLLECTOR_MAX_FILE_DESCRIPTORS = 3000


UID_DOMAIN = jaws-condor
#UID_DOMAIN = nmdc-condor
#DAEMON_LIST = MASTER, STARTD
DAEMON_LIST = MASTER, COLLECTOR, NEGOTIATOR, SCHEDD
#, STARTD

DISCARD_SESSION_KEYRING_ON_STARTUP = False

START = True
SUSPEND = False
PREEMPT = False
KILL = False

# Machine resource settings
NUM_SLOTS = 6
#CLIENTGROUP = "hpc"

#SHARED_PORT_ARGS = -p 9625
USE_SHARED_PORT = TRUE

#STARTD_ATTRS = CLIENTGROUP

#CCB_ADDRESS = condor
#PRIVATE_NETWORK_NAME = cori12-144.nersc.gov
PRIVATE_NETWORK_NAME = cori20-224.nersc.gov

# Logs are written to LOCAL_DIR 
# To change the LOCAL_DIR setting, 
# Need spool and log subdirectories like <local_dir>/spool and <local_dir>/log
# and
# <local_dir>/log/daemon_sock
# 
# mkdir -p <local_dor>/log
# mkdir -p <local_dor>/spool
# mkdir -p <local_dor>/log/daemon_sock
# $ chgrp -R jaws_jtm <local_dir>
# $ chmod o+rx <local_dir>/spool
# $ chmod o+rx <local_dir>/log
#LOCAL_DIR = /global/cfs/projectdirs/jaws/condor
LOCAL_DIR = /global/cscratch1/sd/jaws/condor
#RELEASE_DIR = /global/cfs/projectdirs/jaws/condor/condor
RELEASE_DIR = /global/cfs/projectdirs/jaws/jaws-install/condor/condor

HighLoad = 50

NETWORK_INTERFACE = 128.55.224.50
#NETWORK_INTERFACE = 128.55.144.142

FLOCK_FROM = *

SEC_DEFAULT_AUTHENTICATION = REQUIRED
SEC_DEFAULT_AUTHENTICATION_METHODS = PASSWORD
SEC_CLIENT_AUTHENTICATION_METHODS = PASSWORD
SEC_DEFAULT_NEGOTIATION = REQUIRED
SEC_PASSWORD_FILE = /global/cfs/projectdirs/jaws/condor/password.jaws_jtm

# Set this so that anonymous users (including SOAP users) can insert jobs into the queue
# QUEUE_ALL_USERS_TRUSTED = False
# Set anonymous users to map to the SCHEDD_NAME - kbase by default
# CONDOR_ANONYMOUS_USER = kbase

#SEC_DAEMON_AUTHENTICATION = REQUIRED
#SEC_DAEMON_INTEGRITY = REQUIRED
#SEC_DAEMON_AUTHENTICATION_METHODS = PASSWORD
#SEC_NEGOTIATOR_AUTHENTICATION = REQUIRED
#SEC_NEGOTIATOR_INTEGRITY = REQUIRED
#SEC_NEGOTIATOR_AUTHENTICATION_METHODS = PASSWORD
#SEC_CLIENT_AUTHENTICATION_METHODS = PASSWORD
#ALLOW_DAEMON = condor_pool@$(UID_DOMAIN)/*, \
#               jaws_jtm@$(UID_DOMAIN)/$(IP_ADDRESS)
#ALLOW_NEGOTIATOR = condor_pool@$(UID_DOMAIN)/*,jaws_jtm@$(UID_DOMAIN)/$(IP_ADDRESS)
#ALLOW_COLLECTOR = condor_pool@$(UID_DOMAIN)/*,jaws_jtm@$(UID_DOMAIN)/$(IP_ADDRESS)
#ALLOW_ADVERTISE_STARTD = condor_pool@$(UID_DOMAIN)/*,jaws_jtm@$(UID_DOMAIN)/$(IP_ADDRESS)

# Options for frequency of negotiation, and minimum time length of the negotiation cycle
NEGOTIATOR_INTERVAL = 5
NEGOTIATOR_CYCLE_DELAY = 5

CONCURRENCY_LIMIT_DEFAULT = 10

REMOVE_SIGNIFICANT_ATTRIBUTES = HEALTH_STATUS_MESSAGE

QUEUE_SUPER_USERS = root, condor, condor_pool, jaws_jtm

SCHEDD_DEBUG = D_FULLDEBUG

MAX_JOBS_PER_OWNER=1000000
MAX_JOB_QUEUE_LOG_ROTATIONS=5
QUEUE_CLEAN_INTERVAL=86400
