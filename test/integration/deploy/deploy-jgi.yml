services:
  - client:
      config_template: templates/client/jaws-client.config
      config_output: $JAWS_INSTALL_DIR/configs/jaws-client.conf
      deploy_script: templates/client/deploy-client
  - central:
      config_template: templates/central/jaws-central.config
      config_output: $JAWS_INSTALL_DIR/configs/jaws-central.conf
      deploy_script: templates/central/deploy-central
      environment:
        JAWS_DEPLOY_CENTRAL: 1
  - site:
      config_template: templates/site/jaws-site.config
      config_output: $JAWS_INSTALL_DIR/configs/jaws-site.conf
      deploy_script: templates/site/deploy-site
      environment:
        JAWS_DEPLOY_SITE: 1
        JAWS_DEPLOY_CLIENT: 1
  - cromwell:
      config_template: templates/cromwell/cromwell-singularity.config
      config_output: $JAWS_INSTALL_DIR/configs/cromwell.conf
      deploy_script: templates/cromwell/deploy-cromwell
  - jtm:
      config_template: templates/jtm/jaws-jtm.config
      config_output: $JAWS_INSTALL_DIR/configs/jaws-jtm.conf
      deploy_script: templates/jtm/deploy-jaws-jtm
  - jaws_prometheus:
      config_template: templates/monitor/jaws-prometheus.conf
      config_output: $JAWS_INSTALL_DIR/configs/jaws-prometheus.conf
      deploy_script: templates/monitor/deploy-jaws-prometheus
      environment:
        JAWS_DEPLOY_JAWS_PROMETHEUS: 1
  - site_monitor:
      deploy_script: templates/monitor/deploy-site-monitor
      environment:
        JAWS_DEPLOY_SITE_MONITOR: 1
  - supervisor_jaws:
      deploy_script: templates/supervisor/deploy-supervisor-jaws
  - supervisor_jtm:
      deploy_script: templates/supervisor/deploy-supervisor-jtm
  - supervisor_monitor:
      deploy_script: templates/supervisor/deploy-supervisor-monitorr

service_group:
  jaws: [client, central, site, cromwell, jtm, supervisor_jaws, supervisor_jtm]
  monitor: [site_monitor, supervisor_monitor]

environment:
  JAWS_INSTALL_DIR:
  JAWS_SRC_DIR:
  JAWS_DEPLOY_NAME: dev
  JAWS_SITE_NAME: JGI
  JAWS_DEVELOPER_MODE: 0
  JAWS_IS_LOCAL_DEV_ENV: 0

  JAWS_VERSION: 2.0.1
  JAWS_DOCS_URL: https://jaws-docs.readthedocs.io/en/latest

  JAWS_CENTRAL_HOST: jaws.lbl.gov
  JAWS_CENTRAL_DB_HOST: jaws-db.lbl.gov
  JAWS_CENTRAL_DB_PORT: 3306
  JAWS_CENTRAL_DB_NAME: jaws_central_${JAWS_DEPLOY_NAME}
  JAWS_CENTRAL_DB_USER: jaws
  JAWS_CENTRAL_DB_PWD: $JAWS_CENTRAL_DB_PW
  JAWS_CENTRAL_RMQ_HOST: rmq.lbl.gov
  JAWS_CENTRAL_RMQ_PORT: 5672
  JAWS_CENTRAL_RMQ_VHOST: jaws_${JAWS_DEPLOY_NAME}
  JAWS_CENTRAL_RMQ_QUEUE: CENTRAL
  JAWS_CENTRAL_RMQ_USER: jaws
  JAWS_CENTRAL_RMQ_PWD: $JAWS_CENTRAL_RMQ_PW
  JAWS_CENTRAL_GLOBUS_CLIENT_ID: 29a47d96-76b4-4f2b-a8bb-a4cb38ea17e3
  JAWS_CENTRAL_GLOBAL_CLIENT_SECRET: $JAWS_GLOBUS_CLIENT_SECRET
  JAWS_CENTRAL_AUTH_PORT: 3004
  JAWS_CENTRAL_REST_PORT: 5004

  JAWS_CLIENT_SITE_NAME_ID: $JAWS_SITE_NAME
  JAWS_CLIENT_INSTALL_DIR: $JAWS_INSTALL_DIR/client
  JAWS_CLIENT_GROUP_PERMS: jgi
  JAWS_CLIENT_NAME: jaws-$JAWS_DEPLOY_NAME
  JAWS_CLIENT_REST_URL: http://jaws.lbl.gov
  JAWS_CLEINT_STAGING_DIR: /global/scratch/jaws/jaws-$DEPLOY_NAME/users
  JAWS_CLIENT_DATA_REPO_DIR: /global/cfs/cdirs/jaws/data-repository-$DEPLOY_NAME
  JAWS_CLIENT_SHARED_ENDPOINT_GROUP: jgi
  JAWS_CLIENT_WOMTOOL_JAR: /global/home/groups-sw/lr_jgicloud/cromwell/womtool-52.jar
  JAWS_CLIENT_GLOBUS_CLIENT_ID: 29a47d96-76b4-4f2b-a8bb-a4cb38ea17e3
  JAWS_CLIENT_GLOBUS_ENDPOINT_ID: be1ff650-dcbc-11ea-85a2-0e1702b77d41
  JAWS_CLIENT_GLOBUS_BASEDIR: /

  JAWS_SITE_CORI_HOST: cori20.nersc.gov
  JAWS_SITE_CORI_GLOBUS_ENDPOINT_ID: be1ff650-dcbc-11ea-85a2-0e1702b77d41
  JAWS_SITE_CORI_GLOBUS_UPLOADS_SUBDIR: /global/cscratch1/sd/jaws_jtm/jaws-dev/uploads
  JAWS_SITE_CORI_GLOBUS_ROOT_DIR: /
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_HOST: rmq.lbl.gov
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_PORT: 5672
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_VHOST: jaws_$JAWS_DEPLOY_NAME
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_QUEUE: JAWS_$JAWS_SITE_NAME
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_USER: jaws
  JAWS_SITE_CORI_JAWS_RMQ_CENTRAL_PWD: $JAWS_SITE_CORI_RMQ_PW

  JAWS_SITE_JGI_HOST: lrc-services.lbl.gov
  JAWS_SITE_JGI_GLOBUS_ENDPOINT_ID: 45afb626-a4bd-11e8-96f0-0a6d4e044368
  JAWS_SITE_JGI_GLOBUS_UPLOADS_SUBDIR: /global/scratch/jaws/jaws-dev/uploads
  JAWS_SITE_JGI_GLOBUS_ROOT_DIR: /
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_HOST: rmq.lbl.gov
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_PORT: 5672
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_VHOST: jaws_$JAWS_DEPLOY_NAME
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_QUEUE: JAWS_$JAWS_SITE_NAME
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_USER: jaws
  JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_PWD: $JAWS_SITE_LBNL_RMQ_PW

  JAWS_SITE_INSTALL_DIR: $JAWS_INSTALL_DIR/site
  JAWS_SITE_REF_DATA_DIR: /global/home/groups/lr_jgicloud/refdata
  JAWS_SITE_UPLOADS_SUBDIR: $JAWS_SITE_JGI_GLOBUS_UPLOADS_SUBDIR
  JAWS_SITE_GLOBUS_DOWNLOADS_SUBDIR: /global/scratch/jaws/jaws-dev/downloads
  JAWS_SITE_JAWS_GROUP_PERMISSION: jaws
  JAWS_SITE_JTM_GROUP_PERMISSION: jaw_jtm
  JAWS_SITE_CLIENT_GROUP_PERMISSION: jgi
  JAWS_SITE_GLOBUS_CLIENT_ID: 29a47d96-76b4-4f2b-a8bb-a4cb38ea17e3
  JAWS_SITE_GLOBUS_CLIENT_SECRET: $JAWS_GLOBUS_CLIENT_SECRET
  JAWS_SITE_GLOBUS_ENDPOINT_ID: $JAWS_SITE_JGI_GLOBUS_ENDPOINT_ID
  JAWS_SITE_GLOBUS_ROOT_DIR: $JAWS_SITE_JGI_GLOBUS_ROOT_DIR
  JAWS_SITE_GLOBUS_UPLOADS_SUBDIR: $JAWS_SITE_JGI_GLOBUS_UPLOADS_SUBDIR
  JAWS_SITE_GLOBUS_DEFAULT_DIR: '~'
  JAWS_SITE_SCRATCH_DIR: $JAWS_INSTALL_DIR/site_scratch_dir
  JAWS_SITE_JAWS_DB_HOST: jaws-db.lbl.gov
  JAWS_SITE_JAWS_DB_PORT: 3306
  JAWS_SITE_JAWS_DB_NAME: jaws_jgi_$JAWS_DEPLOY_NAME
  JAWS_SITE_JAWS_DB_USER: jaws
  JAWS_SITE_JAWS_DB_PWD: $JAWS_SITE_CORI_DB_PW
  JAWS_SITE_JAWS_RMQ_LOCAL_HOST: rmq.lbl.gov
  JAWS_SITE_JAWS_RMQ_LOCAL_PORT: 5672
  JAWS_SITE_JAWS_RMQ_LOCAL_VHOST: jaws_$JAWS_DEPLOY_NAME
  JAWS_SITE_JAWS_RMQ_LOCAL_QUEUE: SITE_$JAWS_SITE_NAME
  JAWS_SITE_JAWS_RMQ_LOCAL_USER: jaws
  JAWS_SITE_JAWS_RMQ_LOCAL_PWD: $JAWS_SITE_LBNL_RMQ_PW
  JAWS_SITE_JAWS_RMQ_CENTRAL_HOST: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_HOST
  JAWS_SITE_JAWS_RMQ_CENTRAL_PORT: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_PORT
  JAWS_SITE_JAWS_RMQ_CENTRAL_VHOST: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_VHOST
  JAWS_SITE_JAWS_RMQ_CENTRAL_QUEUE: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_QUEUE
  JAWS_SITE_JAWS_RMQ_CENTRAL_USER: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_USER
  JAWS_SITE_JAWS_RMQ_CENTRAL_PWD: $JAWS_SITE_JGI_JAWS_RMQ_CENTRAL_PWD

  JAWS_SITE_JTM_HOST_NAME: $JAWS_SITE_NAME
  JAWS_SITE_JTM_USER_NAME: jtm_$JAWS_DEPLOY_NAME
  JAWS_SITE_JTM_SCRATCH_DIR: $JAWS_INSTALL_DIR/jtm_scratch_dir
  JAWS_SITE_JTM_WORKER_CONFIG_FILE: $JAWS_INSTALL_DIR/configs/jaws-jtm.conf
  JAWS_SITE_JTM_WORKER_INSTALL_DIR: $JAWS_INSTALL_DIR/jtm-worker
  JAWS_SITE_JTM_ENV_ACTIVATION: $JAWS_INSTALL_DIR/jtm
  JAWS_SITE_JTM_CONFIG_FILE: $JAWS_INSTALL_DIR/configs/jaws-jtm.conf
  JAWS_SITE_JTM_DB_HOST: jaws-db.lbl.gov
  JAWS_SITE_JTM_DB_PORT: 3306
  JAWS_SITE_JTM_DB_NAME: jtm_jgi_$JAWS_DEPLOY_NAME
  JAWS_SITE_JTM_DB_USER: jaws
  JAWS_SITE_JTM_DB_PWD: $JAWS_JTM_CORI_DB_PW
  JAWS_SITE_JTM_RMQ_HOST: rmq.lbl.gov
  JAWS_SITE_JTM_RMQ_PORT: 5672
  JAWS_SITE_JTM_RMQ_VHOST: jtm_$JAWS_DEPLOY_NAME
  JAWS_SITE_JTM_RMQ_USER: jaws
  JAWS_SITE_JTM_RMQ_PWD: $JAWS_JTM_RMQ_CORI_PW

  JAWS_CROMWELL_ROOT: ''
  JAWS_CROMWELL_DOCKER_ROOT: $JAWS_INSTALL_DIR/cromwell-executions
  JAWS_CROMWELL_WORKFLOW_LOG_DIR: $JAWS_INSTALL_DIR/cromwell-workflow-logs
  JAWS_CROMWELL_REF_DATA_DIR: $JAWS_SITE_REF_DATA_DIR
  JAWS_CROMWELL_TMP_DIR: $JAWS_INSTALL_DIR/cromwell-tmp
  JAWS_CROMWELL_JAR_FILE: /global/home/groups-sw/lr_jgicloud/cromwell/cromwell-52.jar
  JAWS_CROMWELL_URL: http://localhost
  JAWS_CROMWELL_LOAD_JAVA: ''
  JAWS_CROMWELL_CONTAINER_EXEC: /global/home/groups-sw/lr_jgicloud/jtm-dev/singularity_exec.sh
  JAWS_CROMWELL_PORT: 50103
  JAWS_CROMWELL_MYSQL_URL: jdbc:mysql://$JAWS_SITE_JAWS_DB_HOST:$JAWS_SITE_JAWS_DB_PORT/cromwell_jgi_${JAWS_DEPLOY_NAME}?rewriteBatchedStatements=true&useSSL=false&autoReconnect=true&useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC
  JAWS_CROMWELL_MYSQL_USER: jaws
  JAWS_CROMWELL_MYSQL_PWD: $JAWS_CROMWELL_LBNL_DB_PW

  JAWS_SUPERVISOR_INET_HTTP_SERVER: 0.0.0.0
  JAWS_SUPERVISOR_CTL_URL: http://lrc-services.lbl.gov
  JAWS_SUPERVISOR_USERNAME: jaws
  JAWS_SUPERVISOR_PWD: $JAWS_SUPERVISORD_PW
  JAWS_SUPERVISOR_CORI_JAWS_INSTALL_DIR: /tmp/jaws-supervisord-$JAWS_DEPLOY_NAME
  JAWS_SUPERVISOR_CORI_JTM_INSTALL_DIR: /tmp/jaws-supervisord-$JAWS_DEPLOY_NAME
  JAWS_SUPERVISOR_JGI_JAWS_INSTALL_DIR: /global/home/groups-sw/lr_jgicloud/jaws-install/jaws-supervisord-$JAWS_DEPLOY_NAME
  JAWS_SUPERVISOR_JGI_JTM_INSTALL_DIR: /global/home/groups-sw/lr_jgicloud/jaws-install/jaws-supervisord-$JAWS_DEPLOY_NAME
  JAWS_SUPERVISOR_CENTRAL_INSTALL_DIR: /tmp/jaws-central-supervisord-$JAWS_DEPLOY_NAME
  JAWS_SUPERVISOR_INSTALL_DIR: $JAWS_INSTALL_DIR/supervisor
  JAWS_SUPERVISOR_JAWS_PORT: 64103
  JAWS_SUPERVISOR_JTM_PORT: 64113
  JAWS_SUPERVISOR_CENTRAL_PORT: 64123
  JAWS_SUPERVISOR_MONITOR_PORT: 64133

  JAWS_PROMETHEUS_PORT: 9183
  JAWS_PROMETHEUS_GROUP_PERMISSON: ''
  JAWS_MONITOR_SUPERVISOR_DIR: $JAWS_SUPERVISOR_INSTALL_DIR
  JAWS_SITE_MONITOR_GROUP_PERMISSON: ''
  JAWS_SITE_MONITOR_CENTRAL_HOST: $JAWS_CENTRAL_HOST
  JAWS_SITE_MONITOR_CENTRAL_PORT: 51003
  JAWS_SITE_MONITOR_CORI_HOST: cori20-224.nersc.gov
  JAWS_SITE_MONITOR_CORI_PORT: 51003
  JAWS_SITE_MONITOR_CORI_DISK_FREE_DIR: /global/cscratch1
  JAWS_SITE_MONITOR_JGI_HOST: $JAWS_SITE_JGI_HOST
  JAWS_SITE_MONITOR_JGI_PORT: 51003
  JAWS_SITE_MONITOR_PORT: $JAWS_SITE_MONITOR_CORI_PORT
  JAWS_SITE_MONITOR_JGI_DISK_FREE_SCRATCH_DIR: /global/scratch
  JAWS_SITE_MONITOR_JGI_DISK_FREE_GROUPS_DIR: /global/home/groups
  JAWS_SITE_MONITOR_JGI_DISK_FREE_GROUPS_SW_DIR: /global/home/groups-sw
  JAWS_SITE_MONITOR_SUPERVISOR_CORI_JAWS_BIN_DIR: $JAWS_SUPERVISOR_CORI_JAWS_INSTALL_DIR/venv/bin
  JAWS_SITE_MONITOR_SUPERVISOR_CORI_JTM_BIN_DIR: $JAWS_SUPERVISOR_CORI_JTM_INSTALL_DIR/venv/bin
  JAWS_SITE_MONITOR_SUPERVISOR_JGI_JAWS_BIN_DIR: $JAWS_SUPERVISOR_JGI_JAWS_INSTALL_DIR/venv/bin
  JAWS_SITE_MONITOR_SUPERVISOR_JGI_JTM_BIN_DIR: $JAWS_SUPERVISOR_JGI_JTM_INSTALL_DIR/venv/bin
  JAWS_SITE_MONITOR_SUPERVISOR_CENTRAL_BIN_DIR: $JAWS_SUPERVISOR_CENTRAL_INSTALL_DIR/venv/bin
  JAWS_SITE_MONITOR_SUPERVISOR_CORI_JAWS_CONFIG: $JAWS_SUPERVISOR_CORI_JAWS_INSTALL_DIR/supervisord-jaws.conf
  JAWS_SITE_MONITOR_SUPERVISOR_CORI_JTM_CONFIG: $JAWS_SUPERVISOR_CORI_JTM_INSTALL_DIR/supervisord-jtm.conf
  JAWS_SITE_MONITOR_SUPERVISOR_JGI_JAWS_CONFIG: $JAWS_SUPERVISOR_JGI_JAWS_INSTALL_DIR-jaws.conf
  JAWS_SITE_MONITOR_SUPERVISOR_JGI_JTM_CONFIG: $JAWS_SUPERVISOR_JGI_JTM_INSTALL_DIR/supervisord-jtm.conf
  JAWS_SITE_MONITOR_SUPERVISOR_CENTRAL_CONFIG: $JAWS_SUPERVISOR_CENTRAL_INSTALL_DIR/supervisord-jaws.conf
